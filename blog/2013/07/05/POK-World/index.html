
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>POK Model and changes to the build system - GSoC 2013 - RTEMS Virtualization Layer Project</title>
  <meta name="author" content="Philipp Eppelt">

  
  <meta name="description" content="I will discuss the POK code and model written to contain the final
RTEMS-POK-Partition-binary and changes and additions to the build system to &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://phipse.github.io/rtems/blog/2013/07/05/POK-World">
  <link href="/rtems/favicon.png" rel="icon">
  <link href="/rtems/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/rtems/atom.xml" rel="alternate" title="GSoC 2013 - RTEMS Virtualization Layer Project" type="application/atom+xml">
  <script src="/rtems/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/rtems/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/rtems/">GSoC 2013 - RTEMS Virtualization Layer Project</a></h1>
  
    <h2>Progress, Issues, Design</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/rtems/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:phipse.github.io/rtems" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/rtems/">Blog</a></li>
  <li><a href="/rtems/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">POK Model and Changes to the Build System</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-07-05T00:00:00+02:00" pubdate data-updated="true">Jul 5<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I will discuss the POK code and model written to contain the final
RTEMS-POK-Partition-binary and changes and additions to the build system to
generate the necessary library.</p>

<!--more-->


<h2>POK libpart</h2>

<p>Up to now POK does not generate a library containing all object files of one
partition, referring to everything in libpok.a and the user defined code
(hello.c). This is done by adding a new makefile target called libpart.</p>

<p>It will build a library libpart.a containing all object files generated by the
user code and all generated files from libpok.a and resides in each partitions
directory.</p>

<p>However, up to now you have to add it by hand to part1/Makefile after invoking
<em>make</em> in the projects root directory (rtems-guest), the ocarina run overwrites
changes to any file in generated-code. Details in <strong>HelloWorld &ndash; describing the
link process</strong>.</p>

<h2>POK example code</h2>

<p>I used the <em>partitioned-threads</em> example as a starting point for my
<em>rtems-guest</em> code. Additionally the header files describing the RTEMS
virtualization layer are copied, namely virtLayerBSP.h and virtLayerCPU.h.
The model.aadl (model) is reduced to generate only one partition.
The hello.c file includes the virtLayer*.h files and implements the defined
functions.</p>

<p>Assuming that POK is configured and the $POK_PATH is set <em>make</em> will check
model and user code and generate the partition and kernel accordingly.</p>

<p>To ensure that POK and RTEMS are using the same calling convention every
function in the virtualization layer has the attribute <strong>fastcall</strong>.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Philipp Eppelt</span></span>

      








  


<time datetime="2013-07-05T00:00:00+02:00" pubdate data-updated="true">Jul 5<span>th</span>, 2013</time>
      


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
      
        <a class="basic-alignment right" href="/rtems/blog/2013/07/05/RTEMS-World/" title="Next Post: RTEMS i386 split - How to support a virtualized CPU">RTEMS i386 split - How to support a virtualized CPU &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/rtems/blog/2013/07/30/midterm-explanation/">Midterm Explanation</a>
      </li>
    
      <li class="post">
        <a href="/rtems/blog/2013/07/28/generation-of-libpart-target/">Generation of Libpart Target</a>
      </li>
    
      <li class="post">
        <a href="/rtems/blog/2013/07/09/how-late-is-it/">How Late Is It?</a>
      </li>
    
      <li class="post">
        <a href="/rtems/blog/2013/07/08/HelloWorld/">Hello World - Describing the Build Process</a>
      </li>
    
      <li class="post">
        <a href="/rtems/blog/2013/07/07/Modeling-the-partition/">Memory Partition and Pointers</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/phipse">@phipse</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'phipse',
            count: 5,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/rtems/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Philipp Eppelt -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
